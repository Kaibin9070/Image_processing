## 期末報告
1. 超音波機器取得超音波影像，格式為dicom檔

2. 將dicom檔轉換為500png影像 (768*1024*500)

3. 500png影像讀取到Matlab中

4. 找出第一張影像的頸動脈區域(因為整張影像大部分都不是我們要的)，接著對後續499張使用機器學習自動找出頸動脈區域 (參數調一調就做好了) (270*220*500)

5. 影像處理
    - 影像上有許多噪點(speckle noise)，一種超音波影像特有的雜訊 : 
        處理方式 : 中值濾波器(功能和均值濾波器雷同)，都是將影像平滑化，就是變糊的意思，只是中值濾波器變糊的副作用比均值濾波器低一些，所以中值濾波器更好
    - 影像變糊之後無法呈現細節 : 
        處理方式 : 將每一個像素都乘上1.3，即增強影像的對比度
    - 將影像二值化以便後續尋找ROI(感興趣區域) :
        處理方式 : 設定一個閾值(eg.25%)，比這個數值更大的像素點全部設定為1，比這個數值更小的像素點全部設定為0
    - 但此時影像會出現一些缺口 :
        處理方式 : 形態學，線性的結構元素(structure element)來填補缺口，其中我們的缺口大約為70度和135度，所以使用這兩個角度的線性結構元素
    - 對500張影像迭代執行一樣的任務 

6. 尋找ROI :
    - snake演算法，在我們目標區域丟一個小矩形，這個小矩形會不斷膨脹直到小矩形的邊緣碰觸到邊界就會停止，否則會一直膨脹下去(這也是為什麼要在上一個填補缺口)
    - 對500張影像迭代執行一樣的任務 

7. 計算ROI(也就是頸動脈)的直徑
    - 頸動脈不是很圓的東西，所以我們使用投影的方式(有個太陽會在目標物體旁旋轉)，直到找到物體的影子最長的角度就會停止，而這個影子的長度就會是這個物體的直徑
    - 演算法名稱 : PCA
    - 對500張影像迭代執行一樣的任務  

8. 透過上述處理可以取得500個數值，即500張影像中，頸動脈的直徑，將這些直徑繪製成一張折線圖(訊號圖)後，取出訊號的波峰、波谷進行後續運算

9. 根據硬化指標公式(我忘了)，將收縮壓、舒張壓、波峰(頸動脈舒張的時候的直徑)、波谷(頸動脈收縮的時候的直徑)代入公式即可取得硬化指標

done...!!!


## 簡易說明

想要探究頸動脈血壓差異與脈搏收縮壓之間的關聯。此實驗的靈感來源於動生實驗心電圖解讀的過程，想要比較這兩種不同的生理測量方法之間是否存在顯著的差異。

- **對比血壓與脈搏收縮壓**：透過分析頸動脈的超音波影像，探討血壓變化與心臟脈搏收縮壓之間的相關性。
- **選擇分析工具**：鑒於 MATLAB 在數據處理和影像分析方面的高效能，本實驗選擇使用 MATLAB 進行數據分析，而非採用機器學習方法。這是基於 MATLAB 已能提供充分的分析精度和效率。


實驗的主要重點在於透過已建立的數據分析方法，有效地解釋和對比這兩種重要的心血管指標，以提供更全面的心血管健康評估。


### 影像輸入與對位
- DICOM 影像轉換為 500 張 PNG 影像，進行影像對位。

### 影像前處理
- **平滑化**：採用 gauss filter，標準差為 1.5。
- **增強對比**：對每個像素點執行 `power(pixel value, 1.3)`。
- **二值化**：閾值設定為 0.25。
- **形態學處理**：填補頸動脈缺口。

### ROI 分割
- 使用 Snakes: Active Contour Models 進行 ROI 計算和分割。

### 計算管腔直徑與繪製曲線
- 利用 PCA 函數提取特徵向量，計算管腔直徑。

### 自動提取 peak 與 valley 計算硬化指標
- 透過訊號的一階差分提取 peak 和 valley。
- 根據數據計算硬化指標。

### 結論與心得
- 雖然和原本找到的論文最後的結果有差距，因論文中的數據來自歐美籍成人，不確定亞洲人的管徑是否會與論文中的數據有所落差
- 當下量測的血壓值若稍有動靜也很可能會大幅影響實驗數據結果　（根據心電圖判讀）

  
